{"version":3,"sources":["px-vis-demos-annotation.es6.js"],"names":["Polymer","is","properties","currentChart","type","Object","isRadarParallel","Boolean","value","currentDimension","String","mousePos","Array","allCharts","dropdownSeries","dropdownDisplayValue","dropdownSelected","annotationText","_lockTooltip","_currentDataEdit","_editAction","editMode","attached","push","$","timeseries","xy","polar","radar","para","forEach","element","addEventListener","createAnnotation","bind","showAnnotation","hideAnnotation","editAnnotation","modal","modalClose","tooltip","_tooltipHide","ttContent","_saveEdit","_deleteEdit","_cancelEdit","evt","detail","data","chart","nodeName","axis","clickTarget","parentElement","set","getAttribute","keys","completeSeriesConfig","mouseCoords","modalButtonClicked","annotationMessage","annotationData","message","icon","forceTemplateRender","setPosition","dom","localTarget","seriesFound","val","newData","getDataFromPixel","x","y","modalText","trim","series","_closeEdit","index","indexOf","splice"],"mappings":"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","file":"px-vis-demos-annotation.js","sourcesContent":["(function() {\n  Polymer({\n\n    is: 'px-vis-demos-annotation',\n\n    properties: {\n      currentChart: {\n        type: Object\n      },\n\n      isRadarParallel: {\n        type: Boolean,\n        value: false\n      },\n\n      currentDimension: {\n        type: String\n      },\n\n      mousePos: {\n        type: Array\n      },\n\n      allCharts: {\n        type: Array\n      },\n\n      dropdownSeries: {\n        type: Array\n      },\n\n      dropdownDisplayValue: {\n        type: String\n      },\n\n      dropdownSelected: {\n        type: String\n      },\n\n      annotationText: {\n        type: String,\n        value: ''\n      },\n\n      //whether the tooltip is locked in place for editing\n      _lockTooltip: {\n        type: Boolean,\n        value: false\n      },\n\n      //current annotation being edited\n      _currentDataEdit: {\n        type: Object\n      },\n\n      //cancel save delete\n      _editAction: {\n        type: String,\n        value: 'cancel'\n      },\n\n      editMode: {\n        type: Boolean,\n        value: false\n      }\n    },\n\n    attached: function() {\n\n      this.allCharts = [];\n      this.allCharts.push(this.$.timeseries);\n      this.allCharts.push(this.$.xy);\n      this.allCharts.push(this.$.polar);\n      this.allCharts.push(this.$.radar);\n      this.allCharts.push(this.$.para);\n\n      this.allCharts.forEach(function(element) {\n        element.addEventListener('px-vis-annotation-creation', this.createAnnotation.bind(this));\n        element.addEventListener('px-vis-annotation-enter', this.showAnnotation.bind(this));\n        element.addEventListener('px-vis-annotation-leave', this.hideAnnotation.bind(this));\n        element.addEventListener('px-vis-annotation-click', this.editAnnotation.bind(this));\n      }, this);\n\n      this.$.modal.addEventListener('btnModalPositiveClicked', this.modalClose.bind(this));\n\n      this.$.tooltip.addEventListener('px-tooltip-hide', this._tooltipHide.bind(this));\n      this.$.ttContent.addEventListener('tooltip-content-save', this._saveEdit.bind(this));\n      this.$.ttContent.addEventListener('tooltip-content-delete', this._deleteEdit.bind(this));\n      this.$.ttContent.addEventListener('tooltip-content-cancel', this._cancelEdit.bind(this));\n    },\n\n    createAnnotation: function(evt) {\n\n      //store current chart for further use\n      this.currentChart = evt.detail.data.chart;\n\n      //get chart type\n      this.isRadarParallel = this.currentChart.nodeName === 'PX-VIS-PARALLEL-COORDINATES' || this.currentChart.nodeName === 'PX-VIS-RADAR';\n\n      //find the series available\n      if(this.isRadarParallel) {\n        //find what axis we clicked on. The click target is the interaction\n        //space on top of the axis\n        var axis = evt.detail.data.clickTarget.parentElement;\n        this.set('currentDimension', axis.getAttribute('dimension'));\n      } else {\n        var keys = Object.keys(this.currentChart.completeSeriesConfig);\n        this.set('dropdownSeries', keys);\n        this.set('dropdownDisplayValue', keys[0]);\n      }\n\n      //store mouse pos for further use\n      this.mousePos = evt.detail.data.mouseCoords;\n\n      //open the modal\n      this.$.modal.modalButtonClicked();\n    },\n\n    showAnnotation: function(evt) {\n\n      if(!this._lockTooltip) {\n\n        this.$.ttContent.annotationMessage = evt.detail.data.annotationData.data.message;\n\n        //this.$.annotationPopover.set('for', evt.detail.data.icon);\n        this.set('_ttTarget', evt.detail.data.icon);\n        this.$.tooltip.set('opened', true);\n      }\n    },\n\n    hideAnnotation: function(evt) {\n      if(!this._lockTooltip) {\n        this.$.tooltip.set('opened', false);\n      }\n    },\n\n    editAnnotation: function(evt) {\n      this._lockTooltip = true;\n\n      this.set('editMode', true);\n\n      //render our templates and repositon based on new content\n      this.$.ttContent.forceTemplateRender();\n      this.$.tooltip.setPosition();\n\n      this._currentDataEdit = evt.detail.data.annotationData;\n      this.currentChart = Polymer.dom(evt).localTarget;\n    },\n\n    modalClose: function(evt) {\n\n      //process data and assign to currentChart\n      var seriesFound,\n          val,\n          newData;\n\n      if(this.isRadarParallel) {\n        seriesFound = this.currentDimension;\n      } else {\n        seriesFound = this.dropdownSelected ? this.dropdownSelected : this.dropdownDisplayValue;\n      }\n\n      val = this.currentChart.getDataFromPixel(this.mousePos, seriesFound);\n      newData = {\n        x: val[0],\n        y: val[1],\n        data: {\n          message: this.$.modalText.value.trim()\n        },\n        series: seriesFound\n      };\n      this.currentChart.push('annotationData', newData);\n      this.$.modalText.value = '';\n    },\n\n    _saveEdit: function(evt) {\n      this._editAction = 'save';\n      this._closeEdit();\n    },\n\n    _cancelEdit: function(evt) {\n      this._editAction = 'cancel';\n      this._closeEdit();\n    },\n\n    _deleteEdit: function(evt) {\n      this._editAction = 'delete';\n      this._closeEdit();\n    },\n\n    _closeEdit: function() {\n      this.$.tooltip.set('opened', false);\n      this.set('editMode', false);\n      this._lockTooltip = false;\n    },\n\n    _tooltipHide: function() {\n\n      var index;\n      if(this._editAction === 'save') {\n        index = this.currentChart.annotationData.indexOf(this._currentDataEdit);\n        this.currentChart.annotationData[index].data.message = this.$.ttContent.annotationMessage;\n      } else if(this._editAction === 'delete') {\n        index = this.currentChart.annotationData.indexOf(this._currentDataEdit);\n        this.currentChart.splice('annotationData', index, 1);\n      }\n\n      this._editAction = 'none';\n    }\n  });\n})();\n"]}