<!doctype html>

<html>
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Crosshair example</title>
      <!-- Requires Webcomponents.js polyfill is provided by the page for browsers that don't support html imports -->
      <!--<script src="../webcomponentsjs/webcomponents-lite.js"></script>-->
      <!-- Import custom element. Note: see comment about relative paths to dependencies in the *.html file referenced below -->
      <link rel="import" href="../promise-polyfill/promise-polyfill-lite.html">
      <!-- <link rel="import" href="../promise-polyfill/promise.js"/> -->
      <link rel="import" href="../px-theme/px-theme-styles.html" defer>
      <!-- <link rel="import" href="../px-dark-theme/px-dark-theme-styles.html"> -->
      <custom-style>
        <style include="px-theme-styles" is="custom-style"></style>
      </custom-style>

      <link rel="import" href="../px-vis/px-vis-data-converter.html" defer />
      <link rel="import" href="../px-vis-timeseries/px-vis-timeseries.html" defer />
      <link rel="import" href="../px-vis-xy-chart/px-vis-xy-chart.html" defer />
      <link rel="import" href="../px-vis-parallel-coordinates/px-vis-parallel-coordinates.html" defer />
      <link rel="import" href="../px-vis-radar/px-vis-radar.html" defer />
      <link rel="import" href="../px-vis-polar/px-vis-polar.html" defer />

      <link rel="import" href="../iron-ajax/iron-ajax.html" defer />

      <link rel="import" href="css/px-vis-demos-styles.html" defer>
      <style include="px-vis-demos-styles" is="custom-style"></style>

  </head>

  <body style="padding:30px; ">
    <dom-bind>
      <template is="dom-bind">
        <style>
          .wapper {
            display: flex;
            flex-wrap: wrap;
          }

          .minHeight {
            margin-top:25px;
            width: 45vw;
            height: 300px;
          }
        </style>
        <div class="wapper">
          <div class="minHeight">
            <px-vis-timeseries
              id="timeseries"
              disable-navigator
              series-config='{
                "y0":{"y":"y0"},
                "y1":{"y":"y1"},
                "y2":{"y":"y2"},
                "y3":{"y":"y3"}
              }'
              default-series-config='{
                "type": "line",
                "x": "timeStamp"
              }'
              cursor-config='{
                "horizontalLine": "none"
              }'
              highlighter-config='{
                "showTooltipData": "true",
                "drawWithLocalCrosshairData": "true"
              }'
              toolbar-config='{
                "config": {
                  "tooltip": {"selected": true},
                  "advancedZoom": true,
                  "crosshairLasso": true,
                  "crosshair": true,
                  "crosshairFrozen": true
                }
              }'
              hard-mute
              chart-data="[[chartData]]"
              render-to-canvas
              crosshair-data="{{crosshairData}}">
            </px-vis-timeseries>
          </div>
          <div class="minHeight">
            <px-vis-xy-chart
              id="xy"
              margin='{
                "top": 5,
                "bottom":25,
                "left":50,
                "right": 10
              }'
              render-to-canvas
              cursor-config='{
                "horizontalLine": "none"
              }'
              series-config='{
                "y1":{"y":"y1"},
                "y2":{"y":"y2"},
                "y3":{"y":"y3"}
              }'
              chart-extents='{
                "x": [-45, -4],
                "y": [-10, 20]
              }'
              register-config='{
                "width": "200",
                "forceDateTimeDisplay": "true"
              }'
              default-series-config='{
                "type": "scatter",
                "x": "y0"
              }'
              highlighter-config='{
                "showTooltipData": "true",
                "drawWithLocalCrosshairData": true
              }'
              hard-mute
              toolbar-config='{
                "config": {
                  "tooltip": {"selected": true},
                  "advancedZoom": true,
                  "crosshairLasso": true,
                  "crosshair": true,
                  "crosshairFrozen": true
                }
              }'
              chart-data="[[chartData]]"
              complete-series-config="{{completeSeriesConfigXY}}"
              time-data="timeStamp"
              crosshair-data="{{crosshairData}}">
            </px-vis-xy-chart>
          </div>
          <div class="minHeight">
            <px-vis-parallel-coordinates
              id="para"
              chart-data="[[chartData]]"

              category-key="category"
              categories='["a","b","c","d"]'
              skip-keys='{"x":true}'
              series-key="timeStamp"
              match-ticks
              generate-axes-from-data
              highlighter-config='{
                "drawWithLocalCrosshairData": true,
                "showTooltipData": "true"
              }'
              show-tooltip
              axis-register-config='{
                "forceDateTimeDisplay": true
              }'
              toolbar-config='{
                "config": {
                  "tooltip": {"selected": true},
                  "advancedZoom": true,
                  "axisMuteSeries": true,
                  "axisDrag": true,
                  "crosshairLasso": true,
                  "crosshair": true,
                  "crosshairFrozen": true
                }
              }'
              hard-mute
              crosshair-data="{{crosshairData}}">
            </px-vis-parallel-coordinates>
          </div>
          <div class="minHeight">
            <px-vis-radar
              id="radar"
              show-tooltip
              chart-data="[[chartData]]"
              category-key="category"
              categories='["a","b","c","d"]'
              skip-keys='{"x":true}'
              series-key="timeStamp"
              generate-axes-from-data
              highlighter-config='{
                "drawWithLocalCrosshairData": true,
                "showTooltipData": "true"
              }'
              axis-register-config='{
                "forceDateTimeDisplay": true
              }'
              toolbar-config='{
                "config": {
                  "tooltip": {"selected": true},
                  "advancedZoom": true,
                  "axisMuteSeries": true,
                  "axisDrag": true,
                  "crosshairLasso": true,
                  "crosshair": true,
                  "crosshairFrozen": true
                }
              }'
              hard-mute
              crosshair-data="{{crosshairData}}">
            </px-vis-radar>
          </div>
          <div class="minHeight">
            <px-vis-polar
              id="polar"
              height="400"
              chart-data="[[chartData]]"
              series-config='{
                "firstSerie": {
                  "y": "y1",
                  "x":"y0"
                },
                "secondSerie": {
                  "y": "y2",
                  "x":"y0"
                }
              }'
              highlighter-config='{
                "drawWithLocalCrosshairData": true,
                "showTooltipData": "true"
              }'
              render-to-canvas
              crosshair-data="{{crosshairData}}"
              toolbar-config='{
                "config": {
                  "tooltip": {"selected": true},
                  "advancedZoom": true,
                  "crosshairLasso": true,
                  "crosshair": true,
                  "crosshairFrozen": true
                }
              }'
              register-config='{
                "forceDateTimeDisplay": true
              }'
              hard-mute
              time-data="timeStamp">
            </px-vis-polar>
          </div>

        <iron-ajax
          id="random1"
          url="../px-demo-data/demo-data/random/d4x1000.json"
          handle-as="json"
          last-response="{{chartData}}"
          auto>
        </iron-ajax>
      </template>
    </dom-bind>
    <script type="text/javascript">

      var timeseries = document.getElementById('timeseries'),
          xy = document.getElementById('xy'),
          para = document.getElementById('para'),
          radar = document.getElementById('radar'),
          polar = document.getElementById('polar');

      // add listener for our unfreeze event.
      document.addEventListener('px-unfreeze-crosshair', function() {

        var empty = {
          rawData: [],
          timeStamps: []
        };

        //get in unfrozen mode
        timeseries.getToolbar().switchConfigItems('crosshairFrozen', 'crosshair');
        xy.getToolbar().switchConfigItems('crosshairFrozen', 'crosshair');
        para.getToolbar().switchConfigItems('crosshairFrozen', 'crosshair');
        radar.getToolbar().switchConfigItems('crosshairFrozen', 'crosshair');
        polar.getToolbar().switchConfigItems('crosshairFrozen', 'crosshair');

        // clear our the crosshairData on all charts
        timeseries.set("crosshairData", empty);
        xy.set("crosshairData", empty);
        para.set("crosshairData", empty);
        radar.set("crosshairData", empty);
        polar.set("crosshairData", empty);
      });

      document.addEventListener('px-freeze-crosshair', function() {

        //get in frozen mode
        timeseries.getToolbar().switchConfigItems('crosshair', 'crosshairFrozen');
        xy.getToolbar().switchConfigItems('crosshair', 'crosshairFrozen');
        para.getToolbar().switchConfigItems('crosshair', 'crosshairFrozen');
        radar.getToolbar().switchConfigItems('crosshair', 'crosshairFrozen');
        polar.getToolbar().switchConfigItems('crosshair', 'crosshairFrozen');
      });

      (function() {
        'use strict';

        var onload = function() {
          // For native Imports, manually fire WebComponentsReady so user code
          // can use the same code path for native and polyfill'd imports.
          if (!window.HTMLImports) {
            document.dispatchEvent(
              new CustomEvent('WebComponentsReady', {bubbles: true})
            );
          }
        };

        var webComponentsSupported = (
          'registerElement' in document && 'import' in document.createElement('link') && 'content' in document.createElement('template')
        );

        if (!webComponentsSupported) {
          var script = document.createElement('script');
          script.async = true;
          script.src = '../webcomponentsjs/webcomponents-lite.js';
          script.onload = onload;
          document.head.appendChild(script);
        } else {
          onload();
        }
      })();
    </script>
  </body>

</html>
